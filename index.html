<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Pedí online a negocios de tu barrio. Encontrá locales y registrá el tuyo gratis.">
  <title>Zonaap | Pedidos de tu barrio</title>
  <link rel="icon" href="assets/logo.png">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="styles/base.css"/>
  <style>
    main{max-width:1100px;margin:auto;padding:1rem}
    .topbar{display:grid;grid-template-columns:1fr auto;gap:.8rem;align-items:center;margin:1rem 0}
    .search{display:flex;gap:.5rem}
    .search input{
      flex:1;padding:.9rem 1rem;border:1px solid var(--borde);border-radius:12px;font-size:1rem;outline:none;
      background:#fff;
    }
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem;margin:1rem 0 2rem}
    .card{
      background:var(--card);border:1px solid var(--borde);border-radius:16px;padding:1rem;display:grid;gap:.6rem;
      transition:.15s;box-shadow:0 6px 18px rgba(0,0,0,.06);
    }
    .card:hover{transform:translateY(-2px)}
    .logo{width:80px;height:80px;border-radius:12px;border:1px solid var(--borde);object-fit:cover;background:#eef2f7}
    .name{font-weight:900;font-size:1.1rem;color:#0b376d}
    .meta{font-size:.95rem;color:var(--muted)}
    .pill{display:inline-flex;align-items:center;border:1px dashed var(--borde);padding:.2rem .5rem;border-radius:999px;font-size:.8rem}
    .actions{display:flex;justify-content:space-between;align-items:center;margin-top:.3rem}
    .link{font-weight:900;color:#0b376d;text-decoration:none}
    .no-results{text-align:center;color:var(--muted);margin-top:2rem}
    footer{max-width:1100px;margin:2rem auto;padding:1rem;text-align:center;color:var(--muted)}
    .brand-header{background:linear-gradient(90deg,var(--azul),var(--azul-2));color:#fff;padding:2rem 1rem;text-align:center;display:flex;flex-direction:column;align-items:center;justify-content:center}
    .brand-header h1{font-size:1.8rem;margin:.3rem 0 0}
    .brand-logo{max-height:140px;width:auto;display:block;margin:0 auto 0.5rem}
    @media (min-width:900px){ .brand-logo{max-height:160px} }
  </style>
</head>
<body>
  <nav class="site-nav">
    <div class="nav-wrap">
      <a href="index.html" class="logo">Zonaap</a>
      <div class="links">
        <a href="registro.html">Registrar</a>
        <a href="track.html">Seguimiento</a>
      </div>
    </div>
  </nav>
  <header class="brand-header">
    <img class="brand-logo" src="assets/zonaap-wordmark-invert.svg" alt="Zonaap"/>
    <h1>Pedí online a negocios de tu barrio</h1>
    <p>Buscá un local o registrá el tuyo gratis.</p>
  </header>

  <main>
    <div class="topbar">
      <div class="search">
        <input id="q" type="search" placeholder="Buscar por nombre, rubro o barrio…">
      </div>
      <a class="btn" href="registro.html">➕ Registrar mi local</a>
    </div>

    <div id="grid" class="grid"></div>
  </main>

  <footer>Hecho con ❤ para emprendedores. Gratis y simple.</footer>

  <script>
    const fmt = v => (v||'').toString().toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu,'');
    let LOCALES = [];
    async function load(){
      try{
        const r = await fetch('data/locales.json');
        const json = await r.json();
        LOCALES = json.locales || [];
      }catch{ LOCALES = []; }
      render(LOCALES);
    }
    function render(list){
      const g = document.getElementById('grid'); if(!g) return;
      g.innerHTML = '';
      if(list.length===0){
        g.innerHTML = '<p class="no-results">No encontramos locales que coincidan.</p>';
        return;
      }
      list.forEach(l => {
        const a = document.createElement('article'); a.className='card';
        a.innerHTML = `
          <div style="display:flex;gap:.8rem;align-items:center">
            <img class="logo" src="${l.logo_url || 'assets/logo.png'}" alt="${l.nombre}">
            <div>
              <div class="name">${l.nombre}</div>
              <div class="meta">${l.rubro||'-'} • ${l.barrio||''}</div>
              <div class="pill">${l.abierto===false?'Cerrado por ahora':'Abierto hoy'}</div>
            </div>
          </div>
          <div class="actions">
            <a class="link" href="negocio.html?l=${encodeURIComponent(l.slug)}">Ver tienda →</a>
            <span style="font-weight:800">${l.envio?'Envío disponible':'Retiro'}</span>
          </div>`;
        g.appendChild(a);
      });
    }
    document.getElementById('q').addEventListener('input', e => {
      const q = fmt(e.target.value);
      render(LOCALES.filter(l => [l.nombre,l.slug,l.rubro,l.barrio].some(x => fmt(x).includes(q))));
    });
    load();
  </script>
</body>
</html>
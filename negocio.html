<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tienda | Zonaap</title>
  <link rel="icon" href="assets/zonaap-pro-wordmark.svg">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    body{font-family:'Roboto',sans-serif;background:#f8f9fa;color:#333}
    header{background:linear-gradient(90deg,#003366,#001122);color:#fff;text-align:center;padding:1.6rem 1rem}
    header img{max-height:120px;margin:0 auto .5rem}
    main{padding:1rem;max-width:900px;margin:auto}
    .back{display:inline-flex;gap:.4rem;align-items:center;margin:.6rem 0;text-decoration:none;font-weight:800}
  </style>

  <!-- Netlify Identity widget (necesario para aceptar invitaciones y login del CMS) -->
  


  <!-- Netlify Identity widget -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    (function() {
      function setup(){
        var ni = window.netlifyIdentity;
        if(!ni) return setTimeout(setup, 50);

        // Abrir "Sign up" solo si ven√≠s con invite_token en la URL
        if (window.location.hash && window.location.hash.indexOf('invite_token') !== -1) {
          ni.on('init', function(){ ni.open('signup'); });
        }

        // Hook para enlaces con data-admin-link (no redirigimos solos)
        function goAdmin(){
          var user = ni.currentUser();
          if (user) { window.location.href = '/admin/'; return; }
          ni.open('login');
          ni.once('login', function(){ window.location.href = '/admin/'; });
        }
        document.querySelectorAll('[data-admin-link]').forEach(function(el){
          el.addEventListener('click', function(e){ e.preventDefault(); goAdmin(); });
        });
      }
      setup();
    })();
  </script>


  <style>
    .store-hero{display:flex;gap:14px;align-items:center;background:linear-gradient(90deg,#0b315f,#001a33);color:#fff;border-radius:16px;padding:14px;margin:0 0 12px}
    .store-logo{width:72px;height:72px;border-radius:14px;object-fit:cover;border:2px solid #fff1}
    .store-info h1{margin:0;font-size:1.35rem}
    .store-sub{margin:.15rem 0 0;color:#d1d5db}
    .store-badges{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .badge{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:3px 10px;font-weight:800;font-size:.82rem}
    .badge-ship{background:#fff7ed;color:#9a3412;border:1px solid #fed7aa}
    .badge-open{background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0}
    .cat-nav{position:sticky;top:8px;background:#f8fafc;padding:6px 0;display:flex;gap:8px;flex-wrap:wrap;z-index:5}
    .cat-chip{border:1px solid #cbd5e1;border-radius:999px;padding:6px 10px;background:#fff;cursor:pointer;font-weight:800}
    .producto{border-radius:14px;border:1px solid #e5e7eb;box-shadow:0 1px 3px rgba(0,0,0,.04)}
  </style>

  <style>
    /* Cart FAB always on top */
    .cart-fab{ z-index: 9999 !important; right: 16px; bottom: calc(18px + env(safe-area-inset-bottom)); position: fixed; }
    /* Improve product rows */
    .producto{ background:#fff; border:1px solid #e5e7eb; border-radius:14px; margin:.5rem 0; padding:.7rem 1rem; }
    .producto:hover{ background:#f8fafc }
    .prod-thumb{ width:72px; height:72px; border-radius:14px; border:1px solid #e5e7eb; overflow:hidden; background:#eef2f7 }
    .producto-info h3{ font-size:1.05rem; margin:0 0 .15rem }
    .producto-info p{ color:#475569 }
    .price-new{ font-weight:900; color:#0b376d }
    /* Bottom sheet: slightly larger on desktop */
    @media (min-width: 900px){
      .sheet{ width:760px }
    }
  </style>

</head>
<body>
  <a class="back" href="index.html">‚Üê Volver</a>
  <header>
    <img id="negLogo" src="assets/zonaap-pro-wordmark.svg" alt="Logo">
    <h1 id="negTitle">Tienda</h1>
    <p id="negSub">Hac√© tu pedido desde la web</p>
  </header>

  
<main>
  <section id="storeHero" class="store-hero" aria-labelledby="storeName">
    <img id="storeLogo" class="store-logo" src="assets/zonaap-pro-wordmark-centered.svg" alt="" />
    <div class="store-info">
      <h1 id="storeName">Nombre del local</h1>
      <p id="storeSub" class="store-sub">Subt√≠tulo o lema</p>
      <div id="storeBadges" class="store-badges"></div>
    </div>
  </section>
  <div id="catNav" class="cat-nav" aria-label="Categor√≠as"></div>

    <!-- Tabs y men√∫s generados por tachi-app.js -->
    <div class="tabs" style="display:flex;justify-content:center;gap:1rem;flex-wrap:wrap;margin-bottom:1rem">
      <button id="btn-rotiseria" class="active" onclick="mostrar('rotiseria')">üçï Rotiser√≠a</button>
      <button id="btn-bebidas"  onclick="mostrar('bebidas')">ü•§ Bebidas</button>
    </div>
    <div id="menu-rotiseria"></div>
    <div id="menu-bebidas" style="display:none"></div>

    <!-- Seguimiento -->
    <section id="track" class="track track-hide" aria-labelledby="track-title"></section>
  
  <!-- FAB -->
  <button id="cartFab" type="button" class="cart-fab" hidden title="Ver pedido" aria-label="Ver pedido">
    <span class="cart-icon">üõí</span>
    <span class="cart-total" id="fabTotal">$ 0</span>
    <span class="cart-count" id="fabCount">0</span>
  </button>

</main>

  <!-- FAB + Sheet + Modal + Toasts se inyectan desde tachi-app.js (reusa UI El Tachi) -->
  <script>
    // Lee slug ?l=
    const params = new URLSearchParams(location.search);
    window.ZONAAP_SLUG = params.get('l') || 'demo-tachi';
  </script>
  <script src="tachi-app.js"></script>

  <!-- Backdrop + Bottom-sheet del carrito (El Tachi style) -->
  <div id="sheetBackdrop" class="sheet-backdrop" aria-hidden="true"></div>
  <div id="cartSheet" class="sheet" role="dialog" aria-modal="true" aria-labelledby="sheetTitle" aria-hidden="true">
    <div class="sheet-header">
      <span class="sheet-handle" aria-hidden="true"></span>
      <h3 id="sheetTitle" class="sheet-title">Tu pedido</h3>
      <div class="steps" id="checkoutSteps" aria-label="Progreso">
        <div class="step" data-step="1"><span class="dot"></span><span>Datos</span></div>
        <span>‚Üí</span>
        <div class="step" data-step="2"><span class="dot"></span><span>Resumen</span></div>
        <span>‚Üí</span>
        <div class="step" data-step="3"><span class="dot"></span><span>WhatsApp</span></div>
      </div>
      <button id="sheetClose" type="button" class="sheet-close" aria-label="Cerrar">‚úï</button>
    </div>
    <div id="sheetBody" class="sheet-body" tabindex="0">
      <section id="checkout">
        <div class="segmented" role="tablist" aria-label="Entrega">
          <input id="opt-ret" type="radio" name="envio" value="retiro">
          <label for="opt-ret">Retiro</label>
          <input id="opt-env" type="radio" name="envio" value="envio">
          <label for="opt-env">Env√≠o</label>
        </div>

        <label>Nombre:
          <input type="text" id="nombre" placeholder="Tu nombre">
        </label>

        <label>Direcci√≥n:
          <input type="text" id="direccion" placeholder="Calle, n√∫mero, piso/depto">
        </label>

        <div id="resumen">
          <h3>Resumen del pedido</h3>
          <p id="emptyMsg" class="resumen-empty">A√∫n no agregaste productos.</p>
          <ul id="lista" class="resumen-list"></ul>

          <div class="totales" aria-live="polite">
            <div class="tot-line"><span>Subtotal</span><span id="subtotal">$ 0</span></div>
            <div id="envioLine" class="tot-line" hidden><span>Env√≠o</span><span id="envioCosto"></span></div>
            <div class="tot-line"><span>Descuento</span><span id="descMonto">$ 0</span></div>
            <div class="tot-line"><span>Propina</span><span id="propMonto">$ 0</span></div>
            <div class="tot-line total"><span>Total</span><span id="total">$ 0</span></div>
          </div>

          <div class="acciones">
            <button id="btn-whatsapp" onclick="enviarPedido()">Hacer pedido por WhatsApp</button>
            <button id="btn-vaciar"   type="button" onclick="vaciarCarrito()">Vaciar carrito</button>
          </div>
        </div>
      </section>
    </div>
  </div>

</body>
</html>
